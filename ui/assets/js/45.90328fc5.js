(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{589:function(t,v,s){"use strict";s.r(v);var _=s(3),a=Object(_.a)({},(function(){var t=this,v=t.$createElement,s=t._self._c||v;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("ul",[s("li",[s("a",{attrs:{href:"#introduce"}},[t._v("Introduce")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#props"}},[t._v("Props")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#events"}},[t._v("Events")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#methods"}},[t._v("Methods")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%80%82%E9%85%8D"}},[t._v("服务端适配")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0"}},[t._v("断点续传")])])]),t._v(" "),s("h2",{attrs:{id:"introduce"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#introduce"}},[t._v("#")]),t._v(" Introduce")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("ui-file-uploader")]),t._v(" 组件需要手动引入; 可以对任意类型的文件进行上传")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ui "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@bpui/ui'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nVue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("component")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ui-file-uploader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UIFileUploader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ui-file-uploader")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("serverUrl")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://127.0.0.1:8080/upload"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),s("ui-file-uploader",{attrs:{serverUrl:"http://127.0.0.1:8080/upload"}}),t._v(" "),s("ul",[s("li",[t._v("可以上传任意类型文件")]),t._v(" "),s("li",[t._v("上传相应类型文件, 图标会变为文件类型图标; 如果是图片,会显示缩略图")]),t._v(" "),s("li",[t._v("有上传进度, 可以取消")])]),t._v(" "),s("h2",{attrs:{id:"props"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#props"}},[t._v("#")]),t._v(" Props")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("名称")]),t._v(" "),s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("描述")]),t._v(" "),s("th",[t._v("默认")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("coverUrl")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("初始状态时显示的封面图片")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("serverUrl")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("上传服务器的地址")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("data")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("需要上传到服务端的字符串.")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("accept")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("接受文件的类型; (html content-type)")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("maxFileSize")]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td",[t._v("允许上传的最大文件.0表示无限制.")]),t._v(" "),s("td",[t._v("0")])]),t._v(" "),s("tr",[s("td",[t._v("timeout")]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td",[t._v("上传超时 (ms)")]),t._v(" "),s("td",[t._v("10000")])]),t._v(" "),s("tr",[s("td",[t._v("disabled")]),t._v(" "),s("td",[t._v("boolean")]),t._v(" "),s("td",[t._v("是否禁用")]),t._v(" "),s("td",[t._v("false")])]),t._v(" "),s("tr",[s("td",[t._v("httpHeaders")]),t._v(" "),s("td",[t._v("any")]),t._v(" "),s("td",[t._v("上传时的请求headers对象")]),t._v(" "),s("td",[t._v("-")])]),t._v(" "),s("tr",[s("td",[t._v("crossDomain")]),t._v(" "),s("td",[t._v("boolean")]),t._v(" "),s("td",[t._v("是否支持跨域")]),t._v(" "),s("td",[t._v("true")])]),t._v(" "),s("tr",[s("td",[t._v("withCredentials")]),t._v(" "),s("td",[t._v("boolean")]),t._v(" "),s("td",[t._v("是否附带cookie")]),t._v(" "),s("td",[t._v("true")])]),t._v(" "),s("tr",[s("td",[t._v("tip")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("提示文字")]),t._v(" "),s("td",[t._v("'将文件拖到此处,或点击上传'")])]),t._v(" "),s("tr",[s("td",[t._v("tipCancel")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("提示文字")]),t._v(" "),s("td",[t._v("'点击取消'")])]),t._v(" "),s("tr",[s("td",[t._v("enableDragFile")]),t._v(" "),s("td",[t._v("boolean")]),t._v(" "),s("td",[t._v("打开拖拽文件特性")]),t._v(" "),s("td",[t._v("true")])]),t._v(" "),s("tr",[s("td",[t._v("textErrFileNotFound")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("错误提示: 找不到文件")]),t._v(" "),s("td",[t._v("'未选择文件!'")])]),t._v(" "),s("tr",[s("td",[t._v("textErrFileSizeExceed")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("错误提示: 选择的文件大小超过最大值")]),t._v(" "),s("td",[t._v("'选择的文件大小超出最大值!'")])]),t._v(" "),s("tr",[s("td",[t._v("textErrFileHashError")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("错误提示: 文件读取错误")]),t._v(" "),s("td",[t._v("'计算文件哈希值时发生错误,请重新选择文件!'")])]),t._v(" "),s("tr",[s("td",[t._v("textErrNetError")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td",[t._v("错误提示: 网络错误")]),t._v(" "),s("td",[t._v("'网络错误,请稍后重试!'")])]),t._v(" "),s("tr",[s("td",[t._v("breakpointResume")]),t._v(" "),s("td",[t._v("("),s("br"),t._v(" file:File,"),s("br"),t._v(" crc32:number,"),s("br"),t._v(" cb:(sliceOffset: number)=>void)"),s("br"),t._v("=>void")]),t._v(" "),s("td",[t._v("(断点续传) 上传文件前进行确认从哪个偏移地址开始上传")]),t._v(" "),s("td",[t._v("-")])])])]),t._v(" "),s("h2",{attrs:{id:"events"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[t._v("#")]),t._v(" Events")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("名称")]),t._v(" "),s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("uploadSuccess")]),t._v(" "),s("td",[t._v("(responseData:any)=>void")]),t._v(" "),s("td",[t._v("上传成功返回响应数据")])]),t._v(" "),s("tr",[s("td",[t._v("uploadProgress")]),t._v(" "),s("td",[t._v("(percent:number)=>void")]),t._v(" "),s("td",[t._v("上传进度; percent为0~1")])]),t._v(" "),s("tr",[s("td",[t._v("uploadError")]),t._v(" "),s("td",[t._v("(err:any)=>void")]),t._v(" "),s("td",[t._v("上传出错;")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("错误信息")])]),t._v(" "),s("p",[t._v("当上传发生错误时, err会等于下列值:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("错误信息")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("FILE_NOT_FOUND:"),s("code",[t._v("string")])]),t._v(" "),s("td",[t._v("未选择文件")])]),t._v(" "),s("tr",[s("td",[t._v("FILE_SIZE_EXCEED:"),s("code",[t._v("string")])]),t._v(" "),s("td",[t._v("选择的文件大小超出允许的大小值")])]),t._v(" "),s("tr",[s("td",[t._v("FILE_HASH_ERROR:"),s("code",[t._v("string")])]),t._v(" "),s("td",[t._v("验算文件hash值时出错")])]),t._v(" "),s("tr",[s("td",[t._v("NET_ERROR:"),s("code",[t._v("string")])]),t._v(" "),s("td",[t._v("网络错误")])]),t._v(" "),s("tr",[s("td",[t._v("e:"),s("code",[t._v("Error")])]),t._v(" "),s("td",[t._v("任意的错误对象表明其他错误")])])])]),t._v(" "),s("h2",{attrs:{id:"methods"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#methods"}},[t._v("#")]),t._v(" Methods")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("名称")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("reset():void")]),t._v(" "),s("td",[t._v("重置上传组件")])]),t._v(" "),s("tr",[s("td",[t._v("browseFile():void")]),t._v(" "),s("td",[t._v("浏览文件")])])])]),t._v(" "),s("h2",{attrs:{id:"服务端适配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务端适配"}},[t._v("#")]),t._v(" 服务端适配")]),t._v(" "),s("p",[t._v("客户端会按照如下规范进行请求:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("multipart/form-data")]),t._v(" 格式上传;")]),t._v(" "),s("li",[s("code",[t._v("POST")]),t._v(" 方法")]),t._v(" "),s("li",[t._v("会在请求url后添加 ?"),s("code",[t._v("crc32")]),t._v("=xxx&"),s("code",[t._v("size")]),t._v("=xxx&"),s("code",[t._v("offset")]),t._v("=0; 三个查询参数;\n"),s("ul",[s("li",[t._v("size: 文件总字节大小")]),t._v(" "),s("li",[t._v("crc32: 文件hash值")]),t._v(" "),s("li",[t._v("offset: 当前上传数据的偏移地址.")])])]),t._v(" "),s("li",[t._v("会将data字符串字段添加到url查询参数中 ?"),s("code",[t._v("data")]),t._v("=xxx;")])]),t._v(" "),s("p",[t._v("服务端响应:")]),t._v(" "),s("ul",[s("li",[t._v("响应内容需为"),s("code",[t._v("json")]),t._v("格式")])]),t._v(" "),s("h2",{attrs:{id:"断点续传"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#断点续传"}},[t._v("#")]),t._v(" 断点续传")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ui-file-uploader")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":breakpointResume")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("handleBreakpointResume"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),s("p",[t._v("使用breakpointResume属性传递断点续传方法, 在文件开始上传前, 通过回调告知需要开始上传的偏移地址.")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleBreakpointResume")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" File"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  crc32"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("cb")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sliceOffset"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// check file segment.")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从第101个字节开始上传.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])],1)}),[],!1,null,null,null);v.default=a.exports}}]);